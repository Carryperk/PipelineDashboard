<mat-toolbar>
  <a mat-button [routerLink]="['/environments']">
    <mat-icon>arrow_back</mat-icon>
    <span>Back to list</span>
  </a>
</mat-toolbar>

<mat-card>
  <form #form="ngForm" class="form-full">
    <mat-card-header>
      <mat-card-title>Add Environment</mat-card-title>
    </mat-card-header>
    <td-message label="Info"
                sublabel="The environment type is used for the deployment workflow. Build only will have two steps, 'start' and 'finish' build. Deploy only will only have two steps, 'start' and 'finish' deploy. Build and deploy will have all four steps."
                color="accent" icon="info"></td-message>
    <mat-card-content>
      <mat-radio-group #type="ngModel" name="type" [(ngModel)]="environment.type" [required]="true">
        <mat-radio-button value="build">Build Only</mat-radio-button>
        <mat-radio-button value="deploy">Deploy Only</mat-radio-button>
        <mat-radio-button value="build-deploy">Build and Deploy</mat-radio-button>
        <div *ngIf="type.errors && !form.valid && form.touched">
          <mat-error *ngIf="type.errors.required">
            Type is required
          </mat-error>
        </div>
      </mat-radio-group>
      <div fxLayout="row" fxLayoutGap="10px">
        <mat-form-field fxFlex>
          <input matInput class="form-control" placeholder="Title"
                 required minlength="3" maxlength="32"
                 name="title" [(ngModel)]="environment.title"
                 #title="ngModel">
          <div *ngIf="title.errors && (title.dirty || title.touched)">
            <mat-error *ngIf="title.errors.required">
              Title is required
            </mat-error>
            <mat-error *ngIf="title.errors.minlength">
              Title must be at least 3 characters long.
            </mat-error>
            <mat-error *ngIf="title.errors.maxlength">
              Title cannot be more than 32 characters long.
            </mat-error>
          </div>
        </mat-form-field>
        <mat-form-field fxFlex>
          <input matInput class="form-control" placeholder="Link"
                 minlength="3" maxlength="128"
                 name="link" [(ngModel)]="environment.link"
                 #link="ngModel">
          <div *ngIf="link.errors && (link.dirty || link.touched)">
            <mat-error *ngIf="link.errors.minlength">
              Link must be at least 3 characters long.
            </mat-error>
            <mat-error *ngIf="link.errors.maxlength">
              Link cannot be more than 128 characters long.
            </mat-error>
          </div>
        </mat-form-field>
      </div>
      <div fxLayout="column" fxLayoutGap="10px">
        <mat-form-field>
          <input matInput class="form-control" placeholder="Description"
                 minlength="3" maxlength="128"
                 name="description" [(ngModel)]="environment.description"
                 #description="ngModel">
          <div *ngIf="description.errors && (description.dirty || description.touched)">
            <mat-error *ngIf="description.errors.minlength">
              Description must be at least 3 characters long.
            </mat-error>
            <mat-error *ngIf="description.errors.maxlength">
              Description cannot be more than 128 characters long.
            </mat-error>
          </div>
        </mat-form-field>
        <mat-checkbox [disabled]="true" value="false">Is private
          <mat-icon matTooltip="During ALPHA private is not allowed">info</mat-icon>
        </mat-checkbox>
      </div>
    </mat-card-content>
    <mat-card-actions>
      <a mat-button routerLink="/environments">CANCEL</a>
      <button mat-button color="primary"
              [disabled]="!form.valid"
              (click)="add()">SAVE
      </button>
    </mat-card-actions>
  </form>
</mat-card>
